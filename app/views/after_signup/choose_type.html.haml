.choose-type 
  .container
    .form-fields  
      -if @agent  
        = form_for(@agent, url: wizard_path, id: "user-form-part1", builder: Judge::FormBuilder) do |f|
          .row.radio-header
            .col-md-3
              = link_to image_tag('logo.png'), root_url
            .col-md-9.text-right
              %h2 Please Select a Radio Button
          .row
            .dropdown.form-dropdown
              %button.btn.btn-primary.dropdown-toggle{"data-toggle" => "dropdown", :type => "button"}
                Select Your Agent Type
                %i.fa.fa-chevron-down
              %ul.dropdown-menu
                %li{value: 'None', onclick: "click_radio('mortgage-radio');"} I am a Mortgage Broker
                = f.hidden_field :agent_type, :value => 'Mortgage Broker'
                %li{value: 'None', onclick: "click_radio('mutual-radio');"} I am a Mutual Fund Licensee
                %li{value: 'None', onclick: "click_radio('insurance-radio');"} I am a Life Insurance Licensee
                %li{value: 'None', onclick: "click_radio('cpa-radio');"} I am a CPA
                %li{value: 'None', onclick: "click_radio('other-radio');"} I am an Alternative Representative
                %li{value: 'None', onclick: "click_radio('taxpayer-radio');"} I am Not a Tax Agent              
                
          .row
            .col-md-6.form-radios      
              .form-radio#taxpayer
                .col-md-10
                  %label{:for => "taxpayer-radio"}
                    Taxpayer
                .col-md-2
                  = radio_button :agent, :agent_type, 'None', onclick: "render_partial('taxpayer');", id: "taxpayer-radio"
              .form-radio#mortgage
                .col-md-10 
                  %label{:for => "mortgage-radio"}
                    Mortgage Broker
                .col-md-2
                  = radio_button :agent, :agent_type, 'Mortgage Broker', onclick: "render_partial('mortgage broker');", id: 'mortgage-radio'
              .form-radio#mutual
                .col-md-10
                  %label{:for => "mutual-radio"}
                    Mutual Fund Licensee
                .col-md-2
                  = radio_button :agent, :agent_type, 'Mutual Fund Licensee', onclick: "render_partial('mutual fund licensee');", id: 'mutual-radio'
              .form-radio#insurance
                .col-md-10
                  %label{:for => "insurance-radio"}
                    Life Insurance Licensee
                .col-md-2
                  = radio_button :agent, :agent_type, 'Life Insurance Licensee', onclick: "render_partial('life insurance licensee');", id: 'insurance-radio'
              .form-radio#cpa
                .col-md-10
                  %label{:for => "cpa-radio"}
                    CPA
                .col-md-2
                  = radio_button :agent, :agent_type, 'CPA', onclick: "render_partial('cpa');", id: 'cpa-radio'
              .form-radio#other
                .col-md-10
                  %label{:for => "other-radio"}
                    Other
                .col-md-2
                  = radio_button :agent, :agent_type, 'Other', onclick: "render_partial('other');", id: 'other-radio'
            .col-md-6.partial-wrapper.form-group
              #partial-area
                .partial-info{:data => {:link => 'taxpayer', :title => 'I am Not a Tax Agent'}, :onclick => "set_title('I am Not a Tax Agent'); click_radio('taxpayer-radio'); render_partial('taxpayer');  "}
                  %i.fa.fa-angle-double-right
                  I am not a tax agent
                .partial-info{:data => {:link => 'mortgage', :title => 'I am a Mortgage Broker'}, :onclick => "set_title('I am a Mortgage Broker'); click_radio('mortgage-radio'); render_partial('mortgage broker');"}
                  %i.fa.fa-angle-double-right
                  I am a Mortgage Broker
                .partial-info{:data => {:link => 'mutual', :title => 'I am a Mutual Fund Licensee'}, :onclick => "set_title('I am a Mutual Fund Licensee'); click_radio('mutual-radio'); render_partial('mutual fund licensee');"}
                  %i.fa.fa-angle-double-right
                  I am a Mutual Fund Licensee
                .partial-info{:data => {:link => 'insurance', :title => 'I am a Life Insurance Licensee'}, :onclick => "set_title('I am a Life Insurance Licensee'); click_radio('insurance-radio'); render_partial('life insurance licensee');"}
                  %i.fa.fa-angle-double-right
                  I am a Life Insurance Licensee
                .partial-info{:data => {:link => 'cpa', :title => 'I am a CPA'}, :onclick => "set_title('I am a CPA'); click_radio('cpa-radio'); render_partial('cpa');"}
                  %i.fa.fa-angle-double-right
                  I am a Certified Professional Accountant
                .partial-info{:data => {:link => 'other', :title => 'I am an Alternative Representative'}, :onclick => "set_title('I am an Alternative Representative'); click_radio('other-radio'); render_partial('other');"}
                  %i.fa.fa-angle-double-right
                  I am an Alternate Representative
              .col-md-4.col-md-offset-1
                = f.submit "Continue", class: "btn btn-default btn-flat", id: "submit-button"
      - else 
        :javascript
          window.location.href="/"
      .progressbar{"data-perc" => "75"}
        .bar.color4
          %span
        .label
          %span


:javascript
  $(document).ready(function() {
    $("#submit-button").on('click', function() {
      $('#type').val($(this).attr('data-val'));
    });

    $("#connect-button").on('click', function() {
      $('#type').val('taxpayer');
      $('#edit_agent_3').submit();
    });

    $('.form-dropdown li').on('click', function() {
      $('.form-dropdown .btn').html($(this).text() + ' <i class="fa fa-chevron-down"></i>');
      $(this).addClass('active');
      $('.form-dropdown li').not($(this)).removeClass('active');
    });
  });

  function click_radio(radio) {
    console.log(radio);
    $('#' + radio).screwDefaultButtons("check").prop('checked', true).trigger('click');
    return false;
  }
  function set_title(title) {
    $('.form-dropdown .btn').html(title + ' <i class="fa fa-chevron-down"></i>');
  }
  function render_partial(element) {
    switch(element) {
      case 'taxpayer':
        $('#submit-button').show().prop('value', 'To Get Your NOA, Contact an Agent').attr('data-type', 'taxpayer')
        $('#partial-area').hide().html("#{escape_javascript(render 'taxpayer_form', agent: @agent)}").fadeIn();
        break;
      case 'mortgage broker':
         $('#partial-area').hide().html("#{escape_javascript(render 'mortgage_broker_form', agent: @agent)}").fadeIn();
         $('#submit-button').show().prop('value', 'Continue').attr('data-type', 'mortgage-broker');
        break;
      case 'mutual fund licensee':
         $('#partial-area').hide().html("#{escape_javascript(render 'mutual_fund_licensee_form', agent: @agent)}").fadeIn();
         $('#submit-button').show().prop('value', 'Continue').attr('data-type', 'mutual-fund-licensee');
        break;
      case 'life insurance licensee':
         $('#partial-area').hide().html("#{escape_javascript(render 'life_insurance_licensee_form', agent: @agent)}").fadeIn();
         $('#submit-button').show().prop('value', 'Continue').attr('data-type', 'life-insurance-licensee');
        break;
      case 'cpa':
         $('#partial-area').hide().html("#{escape_javascript(render 'cpa_form', agent: @agent)}").fadeIn();
         $('#submit-button').show().prop('value', 'Continue').attr('data-type', 'cpa');
        break;

      case 'other':
         $('#partial-area').hide().html("#{escape_javascript(render 'other_form', agent: @agent)}").fadeIn();
         $('#submit-button').show().prop('value', 'Continue').attr('data-type', 'other');
        break;
      default:
        $('#partial-area').hide().html('<h3>Please select a radio button </h3>').fadeIn();
        break;

    }

    $('.brokerages_with_autocomplete').autocomplete({
      source: $('.brokerages_with_autocomplete').data('autocompleteurl')
    });
    $('.sub_brokerages_with_autocomplete').autocomplete({
      source: $('.sub_brokerages_with_autocomplete').data('autocompleteurl')
    });
    return $('.datepicker').datepicker({
      format: 'YYYY/MM/DD'
    });
  } 